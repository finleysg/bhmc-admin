PRD item 1: Notes reducer created. 2-step flow (groupâ†’edit). State shape includes clubEvent, selectedGroup, notes, step flags. SET_GROUP extracts notes from group.notes, auto-advances. GO_BACK clears selection. Files: apps/web/app/events/[eventId]/players/notes/reducer.ts. No blockers.

PRD item 2: Reducer unit tests added. Tests cover all actions: SET_EVENT, SET_GROUP (with notes extraction/auto-advance), SET_NOTES, SET_PROCESSING, SET_SUCCESS, SET_ERROR, GO_BACK, RESET. Files: apps/web/app/events/[eventId]/players/notes/__tests__/reducer.test.ts. No blockers.

PRD item 3: Next.js API route created. POST /api/registration/update-notes with registrationId query param. Validates param, proxies to backend /registration/{registrationId}/update-notes using fetchWithAuth. UpdateNotesRequest body (from domain). Files: apps/web/app/api/registration/update-notes/route.ts. No blockers.

PRD item 4: Notes page created with step 1 (group selection). Uses useReducer with notes reducer. Fetches event on mount, dispatches SET_EVENT. Step 1 renders GroupSearch component with step indicator. Selecting group dispatches SET_GROUP with full CompleteRegistration, auto-advances to edit step. Files: apps/web/app/events/[eventId]/players/notes/page.tsx. No blockers.

PRD item 5: Step 2 (edit/submit notes) added to notes page. Shows group summary (course, start info via getStart, player names). Textarea pre-filled with existing notes, bound to state.notes via SET_NOTES. Save button posts to /api/registration/update-notes with UpdateNotesRequest body. Spinner during processing, buttons disabled. Back button (GO_BACK), Start Over button (RESET). Success state shows message with Update More (RESET) and Player Menu buttons. Error shows alert. Files: apps/web/app/events/[eventId]/players/notes/page.tsx. No blockers.

PRD item 6: updateNotes endpoint added to NestJS admin registration controller. POST /:registrationId/update-notes endpoint accepts UpdateNotesRequest body, logs update attempt with registration ID, calls playerService.updateNotes(registrationId, request.notes), returns { success: boolean }. PlayerService.updateNotes method fetches registration by ID, throws NotFoundException if not found, updates registration.notes via repository.updateRegistration. Files: apps/api/src/registration/controllers/admin-registration.controller.ts, apps/api/src/registration/services/player.service.ts. No blockers.

PRD items 7-8: Unit tests added for PlayerService.updateNotes method. Tests verify NotFoundException when registration not found, successful updates with new value, and null handling to clear notes. All tests pass. Files: apps/api/src/registration/__tests__/player.service.test.ts. No blockers.
